<html><head><title>Alphabet Soup: Examples</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="TypeChecked" /><meta name="description" content="Typelevel Transformations" /><meta name="og:image" content="/img/poster.png" /><meta name="image" property="og:image" content="/img/poster.png" /><meta name="og:title" content="Alphabet Soup: Examples" /><meta name="title" property="og:title" content="Alphabet Soup: Examples" /><meta name="og:site_name" content="Alphabet Soup" /><meta name="og:url" content="https://github.com/TypeChecked/alphabet-soup" /><meta name="og:type" content="website" /><meta name="og:description" content="Typelevel Transformations" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="Alphabet Soup: Examples" /><meta name="twitter:image" content="http://alphabet-soup.typechecked.io/img/poster.png" /><meta name="twitter:description" content="Typelevel Transformations" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/default.css" /><link rel="stylesheet" href="/css/style.css" /><link rel="stylesheet" href="/css/palette.css" /><link rel="stylesheet" href="/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"><span>Alphabet Soup</span></div></a></li> <li><a href="/docs/index.html" class="">Introduction</a></li> <li><a href="/docs/installation.html" class="">Installation</a></li> <li><a href="/docs/atoms.html" class="">Atoms and Atomisation</a></li> <li><a href="/docs/uniqueness.html" class="">Type Uniqueness</a></li> <li><a href="/docs/examples.html" class=" active ">Examples</a></li> <li><a href="/docs/lensing.html" class="">Lensing</a></li> <li><a href="/docs/tips-tricks.html" class="">Tips and Tricks</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/typechecked/alphabet-soup"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/typechecked/alphabet-soup"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="typechecked" data-github-repo="alphabet-soup"><div class="content-wrapper"><section><h1 id="worked-examples">Worked Examples</h1>

<p>First, some value classes we’ll be using in all the examples:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Atomic</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Username</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
<span class="nd">@Atomic</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">UserId</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>
<span class="nd">@Atomic</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Gender</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
<span class="nd">@Atomic</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">FavouriteAnimal</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
</code></pre></div></div>

<h2 id="example-1-boilerplate-reduction">Example 1: Boilerplate reduction</h2>

<p>You probably have a case class representing a database table, and a different class to return it in the API.</p>

<p>Some times (or most of the time), these are probably very similar or identical. But they need to be separate so you
don’t automatically reveal new database information. Or because you don’t want to reveal sensitive information such
as the user’s internal id.</p>

<p>So imagine the following:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">DbUser</span><span class="o">(</span>
  <span class="n">id</span><span class="k">:</span> <span class="kt">UserId</span><span class="o">,</span>
  <span class="n">name</span><span class="k">:</span> <span class="kt">Username</span><span class="o">,</span>
  <span class="n">gender</span><span class="k">:</span> <span class="kt">Gender</span><span class="o">,</span>
  <span class="n">favouriteAnimal</span><span class="k">:</span> <span class="kt">FavouriteAnimal</span>
<span class="o">)</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">ApiUser</span><span class="o">(</span>
  <span class="n">name</span><span class="k">:</span> <span class="kt">Username</span><span class="o">,</span>
  <span class="n">animal</span><span class="k">:</span> <span class="kt">FavouriteAnimal</span><span class="o">,</span>
  <span class="n">gender</span><span class="k">:</span> <span class="kt">Gender</span>
<span class="o">)</span>
</code></pre></div></div>

<p>Now, to turn one into the other you would usually have to write:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">dbToApi</span><span class="o">(</span><span class="n">u</span><span class="k">:</span> <span class="kt">DbUser</span><span class="o">)</span><span class="k">:</span> <span class="kt">ApiUser</span> <span class="o">=</span> <span class="nc">ApiUser</span><span class="o">(</span>
  <span class="n">name</span> <span class="k">=</span> <span class="nv">u</span><span class="o">.</span><span class="py">name</span><span class="o">,</span>
  <span class="n">animal</span> <span class="k">=</span> <span class="nv">u</span><span class="o">.</span><span class="py">favouriteAnimal</span><span class="o">,</span>
  <span class="n">gender</span> <span class="k">=</span> <span class="nv">u</span><span class="o">.</span><span class="py">gender</span>
<span class="o">)</span>
</code></pre></div></div>

<p>At no point above did we make a choice: that code could write itself. And, indeed, it does! With a <code class="highlighter-rouge">Mixer</code>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">dbToApi2</span><span class="o">(</span><span class="n">u</span><span class="k">:</span> <span class="kt">DbUser</span><span class="o">)</span><span class="k">:</span> <span class="kt">ApiUser</span> <span class="o">=</span> <span class="nc">Mixer</span><span class="o">[</span><span class="kt">DbUser</span>, <span class="kt">ApiUser</span><span class="o">].</span><span class="py">mix</span><span class="o">(</span><span class="n">u</span><span class="o">)</span>
</code></pre></div></div>

<p>Database and API classes can get pretty big, and intertwined. Alphabet soup cuts out a <em>lot</em> of repetitive boilerplate.</p>

<h2 id="example-2-applicativeask">Example 2: <code class="highlighter-rouge">ApplicativeAsk</code></h2>

<h3 id="the-problem">The problem</h3>

<p>Suppose you have the following <code class="highlighter-rouge">ApplicativeAsk</code> instance, for some functor <code class="highlighter-rouge">F[_]</code>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">aa</span><span class="k">:</span> <span class="kt">ApplicativeAsk</span><span class="o">[</span><span class="kt">F</span>, <span class="o">(</span><span class="kt">A</span>, <span class="kt">B</span>, <span class="kt">C</span>, <span class="kt">D</span><span class="o">)]</span> <span class="k">=</span> <span class="kc">null</span>
</code></pre></div></div>

<p>and you wanted to read <code class="highlighter-rouge">(B, D)</code>. You would have to do the following:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">result</span><span class="k">:</span> <span class="kt">F</span><span class="o">[(</span><span class="kt">B</span>, <span class="kt">D</span><span class="o">)]</span> <span class="k">=</span> <span class="nv">aa</span><span class="o">.</span><span class="py">ask</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="n">tuple</span> <span class="k">=&gt;</span> <span class="nv">tuple</span><span class="o">.</span><span class="py">_2</span> <span class="o">-&gt;</span> <span class="nv">tuple</span><span class="o">.</span><span class="py">_4</span><span class="o">)</span>
</code></pre></div></div>

<p>It’s even worse if the tuple is larger, or nested, or contains case classes to project as well.</p>

<p>You might be in a context where <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">C</code> don’t even make sense, so you want to pass in an <code class="highlighter-rouge">ApplicativeAsk[F, (B, D)]</code>
instead, forgetting about <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">C</code>. This would be several lines of canonical code.</p>

<p>Luckily, alphabet soup can reduce this to nothing at the call-site:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">shapeless.</span><span class="o">=:!=</span>

<span class="k">implicit</span> <span class="k">def</span> <span class="nf">getAA</span><span class="o">[</span><span class="kt">M</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">X</span>, <span class="kt">Y</span><span class="o">](</span>
  <span class="k">implicit</span> <span class="n">ax</span><span class="k">:</span> <span class="kt">ApplicativeAsk</span><span class="o">[</span><span class="kt">M</span>, <span class="kt">X</span><span class="o">],</span>
  <span class="n">ev</span><span class="k">:</span> <span class="kt">X</span> <span class="o">=:!=</span> <span class="n">Y</span><span class="o">,</span>
  <span class="n">m</span><span class="k">:</span> <span class="kt">Mixer</span><span class="o">[</span><span class="kt">X</span>, <span class="kt">Y</span><span class="o">]</span>
<span class="o">)</span><span class="k">:</span> <span class="kt">ApplicativeAsk</span><span class="o">[</span><span class="kt">M</span>, <span class="kt">Y</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ApplicativeAsk</span><span class="o">[</span><span class="kt">M</span>, <span class="kt">Y</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">applicative</span> <span class="k">=</span> <span class="nv">ax</span><span class="o">.</span><span class="py">applicative</span>
  <span class="k">def</span> <span class="nf">ask</span><span class="k">:</span> <span class="kt">M</span><span class="o">[</span><span class="kt">Y</span><span class="o">]</span> <span class="k">=</span> <span class="nv">applicative</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="nv">ax</span><span class="o">.</span><span class="py">ask</span><span class="o">)(</span><span class="nv">m</span><span class="o">.</span><span class="py">mix</span><span class="o">)</span>
  <span class="k">def</span> <span class="nf">reader</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">Y</span> <span class="o">=&gt;</span> <span class="n">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">M</span><span class="o">[</span><span class="kt">Z</span><span class="o">]</span> <span class="k">=</span> <span class="nv">ax</span><span class="o">.</span><span class="py">reader</span><span class="o">[</span><span class="kt">Z</span><span class="o">](</span><span class="n">a</span> <span class="k">=&gt;</span> <span class="nf">f</span><span class="o">(</span><span class="nv">m</span><span class="o">.</span><span class="py">mix</span><span class="o">(</span><span class="n">a</span><span class="o">)))</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Now, we have our original <code class="highlighter-rouge">ApplicativeAsk</code>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">implicit</span> <span class="k">val</span> <span class="nv">applicativeAsk</span><span class="k">:</span> <span class="kt">ApplicativeAsk</span><span class="o">[</span><span class="kt">F</span>, <span class="o">(</span><span class="kt">A</span>, <span class="kt">B</span>, <span class="kt">C</span>, <span class="kt">D</span><span class="o">)]</span> <span class="k">=</span> <span class="kc">null</span>
</code></pre></div></div>

<p>and we can get any sub-<code class="highlighter-rouge">ApplicativeAsk</code>, for free:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">implicitly</span><span class="o">[</span><span class="kt">ApplicativeAsk</span><span class="o">[</span><span class="kt">F</span>, <span class="o">(</span><span class="kt">B</span>, <span class="kt">D</span><span class="o">)]]</span>
<span class="n">implicitly</span><span class="o">[</span><span class="kt">ApplicativeAsk</span><span class="o">[</span><span class="kt">F</span>, <span class="o">(</span><span class="kt">B</span>, <span class="kt">A</span><span class="o">)]]</span>
<span class="n">implicitly</span><span class="o">[</span><span class="kt">ApplicativeAsk</span><span class="o">[</span><span class="kt">F</span>, <span class="o">(</span><span class="kt">C</span>, <span class="kt">D</span>, <span class="kt">B</span><span class="o">)]]</span>
<span class="n">implicitly</span><span class="o">[</span><span class="kt">ApplicativeAsk</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">B</span><span class="o">]]</span>
</code></pre></div></div>

</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="/js/main.js"></script></body></html>